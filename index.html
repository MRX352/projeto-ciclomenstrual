<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Interativo do Ciclo Menstrual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        /* Estilos para o gráfico de pizza interativo */
        .pie-chart-container {
            position: relative;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background-image: conic-gradient(
                #fda4af 0deg 64deg,      /* Menstrual (5 dias ~ 64deg) */
                #f9a8d4 64deg 167deg,   /* Folicular (8 dias ~ 103deg) */
                #f0abfc 167deg 180deg,  /* Ovulação (1 dia ~ 13deg) */
                #a5b4fc 180deg 360deg    /* Lútea (14 dias ~ 180deg) */
            );
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .pie-chart-container:hover {
            transform: scale(1.05);
        }
        .pie-chart-piece {
            position: absolute;
            width: 100%;
            height: 100%;
            clip-path: polygon(50% 50%, 50% 0%, 100% 0%, 100% 50%); /* Ajustado via JS */
            transition: opacity 0.3s;
        }
        .pie-chart-piece:hover {
            opacity: 0.8;
        }
        .pie-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70%;
            height: 70%;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
            pointer-events: none; /* Permite cliques através dele */
        }
        /* Efeito de destaque na fase ativa */
        .phase-card.active {
            box-shadow: 0 0 15px rgba(165, 180, 252, 0.8);
            border-color: #a5b4fc;
        }
        /* Estilos para o gráfico de hormônios */
        #hormoneChart {
            max-width: 100%;
            height: auto;
        }
        .hormone-line {
            transition: opacity 0.3s ease, stroke-width 0.2s ease;
        }
        .hormone-line.highlight {
            stroke-width: 4px;
        }
        .hormone-line.hidden {
            opacity: 0;
        }
        .day-marker {
            transition: transform 0.1s linear;
        }
        .legend-item.hidden {
            opacity: 0.5;
            text-decoration: line-through;
        }
        .follower-dot {
            transition: transform 0.1s linear, opacity 0.3s ease;
        }
        .follower-dot.hidden {
            opacity: 0;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <!-- Cabeçalho -->
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-pink-500">O Ciclo Menstrual</h1>
            <p class="text-lg text-gray-600 mt-2">Um guia interativo para entender seu corpo.</p>
        </header>

        <!-- Seção Principal: Diagrama e Informações -->
        <section class="flex flex-col md:flex-row gap-8 items-center justify-center mb-12">
            
            <!-- Diagrama Interativo -->
            <div class="flex flex-col items-center">
                <div id="cycleDiagram" class="pie-chart-container shadow-lg">
                    <div class="pie-center">
                        <span id="centerText" class="font-semibold text-gray-700">Clique em uma fase</span>
                    </div>
                </div>
                <div class="flex flex-wrap justify-center gap-4 mt-6 text-sm">
                    <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-red-300 mr-2"></span>Menstrual</div>
                    <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-pink-300 mr-2"></span>Folicular</div>
                    <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-purple-300 mr-2"></span>Ovulatória</div>
                    <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-indigo-300 mr-2"></span>Lútea</div>
                </div>
            </div>

            <!-- Painel de Informações -->
            <div id="infoPanel" class="w-full md:w-1/2 lg:w-2/5 p-6 bg-white rounded-2xl shadow-md transition-all duration-300">
                <!-- O conteúdo será inserido aqui pelo JavaScript -->
            </div>
        </section>
        
        <!-- Seção dos Gráficos de Hormônios -->
        <section id="hormones" class="bg-white p-6 rounded-2xl shadow-md">
            <h2 class="text-2xl font-bold text-center mb-2 text-indigo-500">Flutuações Hormonais</h2>
            <p class="text-center text-gray-500 mb-6">Use o controle deslizante ou clique na legenda para interagir com o gráfico.</p>
            
            <!-- Controle do Dia -->
            <div class="flex flex-col items-center mb-4">
                <label for="daySlider" class="font-semibold mb-2">Dia do Ciclo: <span id="dayLabel" class="text-indigo-500 font-bold">1</span></label>
                <input id="daySlider" type="range" min="1" max="28" value="1" class="w-full max-w-lg">
            </div>

            <!-- Gráfico SVG -->
            <div class="relative">
                <svg id="hormoneChart" viewBox="0 0 800 400" class="w-full bg-gray-50 rounded-lg"></svg>
                 <div id="tooltip" class="absolute bg-black bg-opacity-70 text-white p-2 rounded-lg text-sm pointer-events-none opacity-0 transition-opacity"></div>
            </div>

            <!-- Legenda do Gráfico -->
            <div id="chartLegend" class="flex flex-wrap justify-center gap-x-6 gap-y-2 mt-4">
                <!-- Legendas inseridas via JS -->
            </div>
        </section>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DADOS DO CICLO ---
            const cycleData = {
                menstrual: {
                    name: 'Fase Menstrual',
                    startDay: 1, endDay: 5,
                    duration: 'Dia 1-5 (aprox.)',
                    color: '#fda4af', lightColor: '#fee2e2',
                    borderColor: 'border-red-300', bgColor: 'bg-red-50', textColor: 'text-red-600',
                    description: 'O ciclo começa com a menstruação. Como a gravidez não ocorreu, os níveis de estrogênio e progesterona caem, fazendo com que o revestimento do útero (endométrio) seja eliminado.',
                    uterus: 'O endométrio é expelido do corpo, resultando no sangramento menstrual.',
                    ovaries: 'Os folículos, pequenos sacos que contêm óvulos, começam a se desenvolver.',
                    symptoms: 'Cólicas, inchaço, fadiga, sensibilidade nos seios, alterações de humor.'
                },
                follicular: {
                    name: 'Fase Folicular',
                    startDay: 6, endDay: 13,
                    duration: 'Dia 1-13 (aprox.)',
                    color: '#f9a8d4', lightColor: '#fce7f3',
                    borderColor: 'border-pink-300', bgColor: 'bg-pink-50', textColor: 'text-pink-600',
                    description: 'Esta fase sobrepõe a menstrual e termina com a ovulação. O cérebro libera o Hormônio Folículo-Estimulante (FSH), que estimula os ovários a produzir folículos. Um folículo se torna dominante e amadurece um óvulo.',
                    uterus: 'O endométrio começa a engrossar novamente, preparando-se para uma possível gravidez.',
                    ovaries: 'Um folículo dominante cresce e produz estrogênio.',
                    symptoms: 'Aumento de energia, melhora do humor, aumento da libido à medida que a ovulação se aproxima.'
                },
                ovulatory: {
                    name: 'Fase Ovulatória',
                    startDay: 14, endDay: 14,
                    duration: 'Dia 14 (aprox.)',
                    color: '#f0abfc', lightColor: '#fae8ff',
                    borderColor: 'border-purple-300', bgColor: 'bg-purple-50', textColor: 'text-purple-600',
                    description: 'O aumento do estrogênio causa um pico súbito do Hormônio Luteinizante (LH), que desencadeia a ovulação. O ovário libera o óvulo maduro.',
                    uterus: 'O endométrio está espesso e receptivo a um óvulo fertilizado.',
                    ovaries: 'O folículo dominante se rompe e libera o óvulo na trompa de Falópio.',
                    symptoms: 'Leve dor pélvica, aumento da temperatura corporal basal, muco cervical claro e elástico.'
                },
                luteal: {
                    name: 'Fase Lútea',
                    startDay: 15, endDay: 28,
                    duration: 'Dia 15-28 (aprox.)',
                    color: '#a5b4fc', lightColor: '#e0e7ff',
                    borderColor: 'border-indigo-300', bgColor: 'bg-indigo-50', textColor: 'text-indigo-600',
                    description: 'Após a ovulação, o folículo rompido se transforma no corpo lúteo, que produz progesterona. A progesterona prepara o útero para a gravidez. Se a fertilização não ocorrer, o corpo lúteo se desintegra, os níveis hormonais caem e o ciclo recomeça.',
                    uterus: 'O endométrio atinge sua espessura máxima e se prepara para a implantação.',
                    ovaries: 'O corpo lúteo produz progesterona e um pouco de estrogênio.',
                    symptoms: 'Sintomas da TPM (Tensão Pré-Menstrual) podem ocorrer, como irritabilidade, inchaço, acne, desejos alimentares.'
                }
            };

            const infoPanel = document.getElementById('infoPanel');
            const centerText = document.getElementById('centerText');
            const cycleDiagram = document.getElementById('cycleDiagram');

            // --- LÓGICA DO DIAGRAMA INTERATIVO ---
            
            const phaseRegions = [
                { phase: 'menstrual', startAngle: 0, endAngle: 64 },
                { phase: 'follicular', startAngle: 64, endAngle: 167 },
                { phase: 'ovulatory', startAngle: 167, endAngle: 180 },
                { phase: 'luteal', startAngle: 180, endAngle: 360 }
            ];

            function updateInfoPanel(phaseKey, updateSlider = false) {
                const phase = cycleData[phaseKey];
                infoPanel.innerHTML = `
                    <div class="phase-card p-4 rounded-lg transition-all duration-300 ${phase.bgColor} border-2 ${phase.borderColor} active">
                        <h3 class="text-2xl font-bold ${phase.textColor}">${phase.name}</h3>
                        <p class="font-semibold text-gray-500 mb-4">${phase.duration}</p>
                        <p class="mb-4">${phase.description}</p>
                        <div class="space-y-3">
                            <div><h4 class="font-semibold">No Útero:</h4><p class="text-sm">${phase.uterus}</p></div>
                            <div><h4 class="font-semibold">Nos Ovários:</h4><p class="text-sm">${phase.ovaries}</p></div>
                            <div><h4 class="font-semibold">Sintomas Comuns:</h4><p class="text-sm">${phase.symptoms}</p></div>
                        </div>
                    </div>`;
                centerText.textContent = phase.name;
                if(updateSlider) {
                    const middleDay = Math.floor((phase.startDay + phase.endDay) / 2);
                    daySlider.value = middleDay;
                    dayLabel.textContent = middleDay;
                    updateMarker(middleDay);
                }
            }

            cycleDiagram.addEventListener('click', (e) => {
                const rect = e.target.getBoundingClientRect();
                const x = e.clientX - rect.left - rect.width / 2;
                const y = e.clientY - rect.top - rect.height / 2;
                
                let angle = Math.atan2(y, x) * (180 / Math.PI) + 90;
                if (angle < 0) angle += 360;

                for (const region of phaseRegions) {
                    if (angle >= region.startAngle && angle < region.endAngle) {
                        updateInfoPanel(region.phase, true);
                        break;
                    }
                }
            });
            
            updateInfoPanel('menstrual');

            // --- LÓGICA DO GRÁFICO DE HORMÔNIOS ---

            const daySlider = document.getElementById('daySlider');
            const dayLabel = document.getElementById('dayLabel');
            const svg = document.getElementById('hormoneChart');
            const legendContainer = document.getElementById('chartLegend');
            const tooltip = document.getElementById('tooltip');
            const svgNS = "http://www.w3.org/2000/svg";

            const hormones = {
                estrogen: { name: 'Estrogênio', color: '#ec4899', data: [2,2,2,3,4,5,6,7,8,9,10,12,11,8,5,4,5,6,6,7,7,6,5,4,3,2,2,2] },
                progesterone: { name: 'Progesterona', color: '#8b5cf6', data: [1,1,1,1,1,1,1,1,1,1,1,1,2,4,6,8,9,10,11,10,9,8,6,4,2,1,1,1] },
                lh: { name: 'Hormônio Luteinizante (LH)', color: '#f59e0b', data: [2,2,2,2,3,3,4,4,5,5,6,15,8,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2] },
                fsh: { name: 'Hormônio Folículo-Estimulante (FSH)', color: '#10b981', data: [4,4,4,4,3,3,3,3,3,3,3,6,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2] },
            };

            const width = 800;
            const height = 400;
            const padding = 50;
            const dayWidth = (width - 2 * padding) / 27;

            // Função para converter pontos em uma curva suave (spline)
            function getSplinePath(points, tension = 0.2) {
                const controlPoint = (current, previous, next, reverse) => {
                    const p = previous || current;
                    const n = next || current;
                    const smoothing = tension;
                    const o = { x: n.x - p.x, y: n.y - p.y };
                    const angle = Math.atan2(o.y, o.x);
                    const length = Math.sqrt(o.x * o.x + o.y * o.y) * smoothing;
                    const x = current.x + Math.cos(angle + (reverse ? Math.PI : 0)) * length;
                    const y = current.y + Math.sin(angle + (reverse ? Math.PI : 0)) * length;
                    return [x, y];
                };

                const path = points.reduce((acc, point, i, a) => {
                    if (i === 0) return `M ${point.x},${point.y}`;
                    const [cpsX, cpsY] = controlPoint(a[i-1], a[i-2], point);
                    const [cpeX, cpeY] = controlPoint(point, a[i-1], a[i+1], true);
                    return `${acc} C ${cpsX},${cpsY} ${cpeX},${cpeY} ${point.x},${point.y}`;
                }, "");
                return path;
            }

            function drawChart() {
                // Fundos das fases
                Object.values(cycleData).forEach(phase => {
                    const rect = document.createElementNS(svgNS, 'rect');
                    const x = padding + (phase.startDay - 1) * dayWidth;
                    const w = (phase.endDay - phase.startDay + 1) * dayWidth;
                    rect.setAttribute('x', x);
                    rect.setAttribute('y', padding / 2);
                    rect.setAttribute('width', w);
                    rect.setAttribute('height', height - padding * 1.5);
                    rect.setAttribute('fill', phase.lightColor);
                    svg.appendChild(rect);
                });

                // Eixo X
                const xAxis = document.createElementNS(svgNS, 'line');
                xAxis.setAttribute('x1', padding);
                xAxis.setAttribute('y1', height - padding);
                xAxis.setAttribute('x2', width - padding);
                xAxis.setAttribute('y2', height - padding);
                xAxis.setAttribute('stroke', '#9ca3af');
                svg.appendChild(xAxis);
                
                // Labels do eixo X
                for (let i = 1; i <= 28; i += 3) {
                    const text = document.createElementNS(svgNS, 'text');
                    text.setAttribute('x', padding + (i - 1) * dayWidth);
                    text.setAttribute('y', height - padding + 20);
                    text.setAttribute('font-size', '12'); text.setAttribute('fill', '#6b7281'); text.setAttribute('text-anchor', 'middle');
                    text.textContent = i;
                    svg.appendChild(text);
                }

                // Desenhar linhas e legendas dos hormônios
                Object.entries(hormones).forEach(([key, hormone]) => {
                    const points = hormone.data.map((point, index) => ({
                        x: padding + index * dayWidth,
                        y: height - padding - point * 20
                    }));
                    
                    const path = document.createElementNS(svgNS, 'path');
                    path.setAttribute('d', getSplinePath(points));
                    path.setAttribute('stroke', hormone.color);
                    path.setAttribute('stroke-width', '3');
                    path.setAttribute('fill', 'none');
                    path.setAttribute('class', `hormone-line hormone-${key}`);
                    path.setAttribute('id', `path-${key}`);
                    svg.appendChild(path);

                    const followerDot = document.createElementNS(svgNS, 'circle');
                    followerDot.setAttribute('r', '5');
                    followerDot.setAttribute('fill', hormone.color);
                    followerDot.setAttribute('stroke', 'white');
                    followerDot.setAttribute('stroke-width', '2');
                    followerDot.setAttribute('class', 'follower-dot');
                    followerDot.setAttribute('id', `dot-${key}`);
                    svg.appendChild(followerDot);

                    // Criar legenda interativa
                    const legendItem = document.createElement('div');
                    legendItem.className = 'flex items-center cursor-pointer legend-item';
                    legendItem.innerHTML = `<span class="w-4 h-4 rounded-full mr-2" style="background-color: ${hormone.color};"></span> ${hormone.name}`;
                    legendItem.addEventListener('click', () => toggleHormone(key));
                    legendContainer.appendChild(legendItem);
                });
                
                // Marcador do dia
                const marker = document.createElementNS(svgNS, 'line');
                marker.setAttribute('id', 'dayMarker');
                marker.setAttribute('y1', padding/2);
                marker.setAttribute('y2', height - padding);
                marker.setAttribute('stroke', '#374151');
                marker.setAttribute('stroke-width', '1.5');
                marker.setAttribute('stroke-dasharray', '4');
                marker.setAttribute('class', 'day-marker');
                svg.appendChild(marker);

                updateMarker(1);
            }
            
            function toggleHormone(key) {
                const path = document.getElementById(`path-${key}`);
                const dot = document.getElementById(`dot-${key}`);
                const legend = Array.from(legendContainer.children).find(child => child.textContent.includes(hormones[key].name));
                path.classList.toggle('hidden');
                dot.classList.toggle('hidden');
                legend.classList.toggle('hidden');
            }

            function updateMarker(day) {
                const x = padding + (day - 1) * dayWidth;
                
                const marker = document.getElementById('dayMarker');
                marker.setAttribute('transform', `translate(${x}, 0)`);

                Object.entries(hormones).forEach(([key, hormone]) => {
                    const y = height - padding - hormone.data[day - 1] * 20;
                    const dot = document.getElementById(`dot-${key}`);
                    dot.setAttribute('transform', `translate(${x}, ${y})`);
                });
            }
            
            daySlider.addEventListener('input', (e) => {
                const day = parseInt(e.target.value);
                dayLabel.textContent = day;
                updateMarker(day);
                
                // Sincronizar com o painel de info
                let currentPhaseKey = 'luteal';
                if (day <= 5) currentPhaseKey = 'menstrual';
                else if (day <= 13) currentPhaseKey = 'follicular';
                else if (day <= 14) currentPhaseKey = 'ovulatory';
                
                // Atualiza o painel, mas sem mexer no slider (false)
                updateInfoPanel(currentPhaseKey, false);
            });

            drawChart();
        });
    </script>
</body>
</html>

